<!doctype html>
<html lang="en-gb">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Alex Edwards">
    <meta name="copyright" content="Copyright Alex Edwards 2017">
    <meta name="google-site-verification" content="cQSliJDuQ3qRlZyVLmjurqMe4x-Q_SxyvXtpQbWRbeY">
    <title>SCS&#58; A session manager for Go 1.7+</title>
    <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700|Fira+Sans:400,400i,700,800" rel="stylesheet">
    <link rel="stylesheet" href="/static/stylesheets/main.css">
    <link rel="alternate"  href="/static/feed.rss" type="application/rss+xml">
  </head>
  <body>
    <header>
      <nav class="wrapper clearfix">
        <div class="breadcrumbs">
          <a href="/">Alex Edwards</a>
          <span class="crumbs">
            
              <span class="separator">&rsaquo;</span>
              <a href="/blog">Blog</a>
            
            
              <span class="separator">&rsaquo;</span>
              SCS&#58; A session manager for Go 1.7+
            
          </span>
        </div>
        <div class="pages">
          <a href="/blog">Blog</a>
          <a href="/static/feed.rss">RSS</a>
        </div>
      </nav>
    </header>
    <section class="wrapper clearfix">
      <article class="primary">
	<h1>SCS&#58; A session manager for Go 1.7+</h1>
	<div class="metadata">
		<span class="dates">
			30th August 2016
			
		</span>
		
		<span class="tags">
			Filed under: <a href="/blog/category/golang" rel="tag">golang</a><a href="/blog/category/open-source" rel="tag">open-source</a>
		</span>
		
	</div>
	<p>I’ve just released SCS, a session management package for Go 1.7+. You can <a href="https://github.com/alexedwards/scs">view it on Github</a>.</p>

<p>Its design leverages Go’s new <code>context</code> package to automatically load and save session data via middleware.</p>

<p>Importantly, it also provides the security features that you need when using server-side session stores (like straightforward session token regeneration) and supports both absolute and inactivity timeouts. The session data is safe for concurrent use.</p>

<h2>A simple example</h2>

<p>SCS is broken up into small single-purpose packages for ease of use. You should install the <code>session</code> package and your choice of session storage engine from the following table:</p>

<table>
<thead>
<tr>
<th>Package</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://godoc.org/github.com/alexedwards/scs/session">session</a></td>
<td>Provides session management middleware and helpers for <br>manipulating session data</td>
</tr>
<tr>
<td><a href="https://github.com/alexedwards/scs/tree/master/engine/memstore">engine/memstore</a></td>
<td>In-memory storage engine</td>
</tr>
<tr>
<td><a href="https://github.com/alexedwards/scs/tree/master/engine/cookiestore">engine/cookiestore</a></td>
<td>Encrypted-cookie based storage engine</td>
</tr>
<tr>
<td><a href="https://github.com/alexedwards/scs/tree/master/engine/pgstore">engine/pgstore</a></td>
<td>PostgreSQL based storage eninge</td>
</tr>
<tr>
<td><a href="https://github.com/alexedwards/scs/tree/master/engine/mysqlstore">engine/mysqlstore</a></td>
<td>MySQL based storage engine</td>
</tr>
<tr>
<td><a href="https://github.com/alexedwards/scs/tree/master/engine/redisstore">engine/redisstore</a></td>
<td>Redis based storage engine</td>
</tr>
</tbody>
</table>

<p>For example:</p>

<figure class="shell"><code><pre>
$ go get github.com/alexedwards/scs/session
$ go get github.com/alexedwards/scs/engine/memstore
</pre></code></figure>

<p>Usage is then simple:</p>

<figure class="file"><figcaption>File: main.go</figcaption><code><pre>
package main

import (
    &quot;io&quot;
    &quot;net/http&quot;

    &quot;github.com/alexedwards/scs/engine/memstore&quot;
    &quot;github.com/alexedwards/scs/session&quot;
)

func main() {
    // Create the session manager middleware, passing in a new storage
    // engine instance as the first parameter.
    sessionManager := session.Manage(memstore.New(0))

    // Set up your HTTP handlers in the normal way.
    mux := http.NewServeMux()
    mux.HandleFunc(&quot;/put&quot;, putHandler)
    mux.HandleFunc(&quot;/get&quot;, getHandler)

    // Wrap your handlers with the session manager middleware.
    http.ListenAndServe(&quot;:4000&quot;, sessionManager(mux))
}

func putHandler(w http.ResponseWriter, r *http.Request) {
    // Use the PutString helper to add a new key and associated string value
    // to the session data. Helpers for other types are included.
    err := session.PutString(r, &quot;message&quot;, &quot;Hello from a session!&quot;)
    if err != nil {
        http.Error(w, err.Error(), 500)
    }
}

func getHandler(w http.ResponseWriter, r *http.Request) {
    // Use the GetString helper to retrieve the value associated with the
    // &quot;message&quot; key.
    msg, err := session.GetString(r, &quot;message&quot;)
    if err != nil {
        http.Error(w, err.Error(), 500)
        return
    }
    io.WriteString(w, msg)
}
</pre></code></figure>

<p>You should be able to verify that the session data is being across requests with curl:</p>

<figure class="shell"><code><pre>
$ curl -i -c cookies localhost:4000/put
<samp>HTTP/1.1 200 OK
Set-Cookie: scs.session.token=uts3FRcCMOIXpyx5uZx28Y54uUFRHxgtYhbgD4epeI4; Path=/; HttpOnly
Date: Tue, 30 Aug 2016 17:37:12 GMT
Content-Length: 0
Content-Type: text/plain; charset=utf-8</samp>

$ curl -i -b cookies localhost:4000/get
<samp>HTTP/1.1 200 OK
Date: Tue, 30 Aug 2016 17:37:21 GMT
Content-Length: 21
Content-Type: text/plain; charset=utf-8

Hello from a session!</samp>
</pre></code></figure>

<p>The complete <a href="https://godoc.org/github.com/alexedwards/scs">godocs are here</a>.</p>

<p>I’d love to hear any feedback &ndash; either drop me an email or <a href="https://github.com/alexedwards/scs/issues">open an issue</a> on Github.</p>
	<div class="social">
		<p class="mit"><img src="https://opensource.org/files/osi_symbol.png" height="30px">All code snippets in this post are free to use under the <a href="http://opensource.org/licenses/MIT">MIT Licence</a>.</p>
		<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>&nbsp;&nbsp;&nbsp;
		<script src="https://apis.google.com/js/platform.js" async defer></script>
		<g:plusone></g:plusone>
	</div>
</article>
<div class="sidebar">
	<div class="lets-go clearfix">
		<a href="https://gumroad.com/l/letsgo"><img src="http://www.alexedwards.net/lets-go/sample/assets/img/cover.png"></a>
		<p> <strong>Found this post useful?</strong> My new book has a heap more step-by-step guidance on how to build a fast, secure and maintainable web application with Go. <a href="https://gumroad.com/l/letsgo">Check it out!</a></p>
	</div>
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="/static/javascripts/highlight.pack.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    $('figure code').each(function(i, e) {hljs.highlightBlock(e)});
  });
</script>
    </section>
    <footer>
      <div class="wrapper">
        <div><span class="copyright">&copy;</span> Alex Edwards 2017 &middot; Built using <a href="https://nanoc.ws">Nanoc</a></div>
      </div>
    </footer>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23830196-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
      </script>
  </body>
</html>
